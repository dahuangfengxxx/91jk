#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import csv

def expand_database_batch4():
    """第四批数据库扩展 - 内脏类食材"""
    
    # 内脏类 (18种)
    organ_meats = [
        ["猪肝", "zhu gan", "食材", "内脏", "温", "甘;苦", "肝", "补肝明目;养血", "肝血不足;夜盲症;贫血", "血虚", "适量为宜", "高胆固醇慎", "四季", "炒/汤", "韭菜;菠菜", "——", "50-100g/餐", "——", "补血佳品，维A含量极高，明目效果显著。", "《本草纲目》/现代营养学"],
        ["猪心", "zhu xin", "食材", "内脏", "平", "甘;咸", "心", "养心安神;补血", "心神不安;心血不足", "血虚、心神不宁", "适量为宜", "——", "四季", "炖/炒", "莲子;红枣", "——", "100-150g/餐", "——", "以脏补脏，养心安神，治疗心悸失眠。", "《本草纲目》/现代营养学"],
        ["猪腰", "zhu yao", "食材", "内脏", "平", "甘;咸", "肾", "补肾壮腰;利水", "肾虚腰痛;水肿", "肾虚", "适量为宜", "高血压慎", "四季", "炒/汤", "韭菜;杜仲", "——", "100-150g/餐", "——", "猪肾，补肾强腰，但胆固醇较高。", "《本草纲目》/现代营养学"],
        ["猪肺", "zhu fei", "食材", "内脏", "平", "甘", "肺", "补肺止咳;清热", "肺虚咳嗽;肺热", "肺虚", "适量为宜", "——", "四季", "炖汤", "川贝;杏仁", "——", "100-200g/餐", "——", "补肺润燥，治疗肺虚久咳。", "《本草纲目》/现代营养学"],
        ["猪胃", "zhu wei", "食材", "内脏", "温", "甘", "胃", "健胃消食;补虚", "胃虚;消化不良", "胃虚", "适量为宜", "——", "四季", "炖/卤", "胡椒;生姜", "——", "100-150g/餐", "——", "猪肚，健胃消食，温中补虚。", "《本草纲目》/现代营养学"],
        ["鸡肝", "ji gan", "食材", "内脏", "温", "甘;微苦", "肝", "补肝明目;养血", "肝血不足;夜盲", "血虚", "适量为宜", "高胆固醇慎", "四季", "炒", "韭菜", "——", "50-80g/餐", "——", "比猪肝更温和，儿童补血佳品。", "现代营养学"],
        ["鸡心", "ji xin", "食材", "内脏", "平", "甘", "心", "养心安神", "心血不足", "血虚", "适量为宜", "——", "四季", "炒/串烧", "——", "——", "50-100g/餐", "——", "小巧精致，营养丰富，烧烤常用。", "现代营养学"],
        ["鸡胗", "ji zhen", "食材", "内脏", "平", "甘", "脾;胃", "健脾消食;涩精", "脾胃虚弱;遗精", "脾虚", "适量为宜", "——", "四季", "炒/卤", "青椒", "——", "100-150g/餐", "——", "鸡肫，健脾消积，口感爽脆。", "《本草纲目》/现代营养学"],
        ["鸭肝", "ya gan", "食材", "内脏", "平", "甘", "肝", "养肝明目", "肝血不足", "血虚", "适量为宜", "高胆固醇慎", "四季", "炒", "韭菜", "——", "50-80g/餐", "——", "性平不燥，适合体质偏热者。", "现代营养学"],
        ["鸭血", "ya xue", "食材", "内脏", "平", "咸", "肝", "养血;解毒", "血虚;中毒", "血虚", "适量为宜", "——", "四季", "汤/火锅", "韭菜;豆腐", "——", "100-150g/餐", "——", "补血佳品，嫩滑可口，火锅必备。", "现代营养学"],
        ["猪血", "zhu xue", "食材", "内脏", "平", "咸", "心;肝", "养血;清肺", "血虚;尘肺", "血虚", "适量为宜", "——", "四季", "汤/炒", "韭菜;豆腐", "——", "100-150g/餐", "——", "血豆腐，清肺补血，环境污染克星。", "现代营养学"],
        ["羊肝", "yang gan", "食材", "内脏", "温", "甘;苦", "肝", "补肝明目;养血", "肝血虚;夜盲", "血虚、阳虚", "适量为宜", "高胆固醇慎", "秋、冬", "炒/汤", "韭菜", "——", "50-100g/餐", "——", "温补效果强于猪肝，适合虚寒体质。", "《本草纲目》/现代营养学"],
        ["羊腰", "yang yao", "食材", "内脏", "温", "甘", "肾", "补肾壮阳;益精", "肾阳虚;阳痿", "肾阳虚", "适量为宜", "——", "秋、冬", "炒/汤", "韭菜;杜仲", "——", "100-150g/餐", "——", "羊肾，温补肾阳，壮阳效果显著。", "《本草纲目》/现代营养学"],
        ["牛肝", "niu gan", "食材", "内脏", "平", "甘", "肝", "补肝明目;养血", "肝血不足;贫血", "血虚", "适量为宜", "高胆固醇慎", "四季", "炒", "韭菜;洋葱", "——", "50-100g/餐", "——", "营养密度高，铁质丰富，补血效果好。", "现代营养学"],
        ["牛心", "niu xin", "食材", "内脏", "平", "甘", "心", "养心安神", "心血不足", "血虚", "适量为宜", "——", "四季", "炖/烧烤", "——", "——", "100-150g/餐", "——", "蛋白质含量高，口感厚实。", "现代营养学"],
        ["牛百叶", "niu bai ye", "食材", "内脏", "平", "甘", "脾;胃", "健脾益胃", "脾胃虚弱", "脾虚", "适量为宜", "——", "四季", "涮/炒", "——", "——", "100-150g/餐", "——", "牛胃，口感爽脆，火锅涮品。", "现代营养学"],
        ["牛舌", "niu she", "食材", "内脏", "平", "甘", "心;脾", "补心健脾", "心脾不足", "气血虚", "适量为宜", "——", "四季", "烧烤/炖", "——", "——", "100-150g/餐", "——", "高档食材，肉质嫩滑，营养丰富。", "现代营养学"],
        ["鹅肝", "e gan", "食材", "内脏", "平", "甘", "肝", "养肝明目", "肝血不足", "血虚", "少量为宜", "高胆固醇慎", "四季", "煎/炒", "——", "——", "50-80g/餐", "——", "法式珍品，营养丰富但脂肪含量极高。", "现代营养学"]
    ]
    
    # 读取现有CSV文件
    input_file = 'ingredients_master.csv'
    rows = []
    
    with open(input_file, 'r', encoding='utf-8') as f:
        reader = csv.reader(f)
        rows = list(reader)
    
    # 在最后一行之前插入新数据
    insert_position = len(rows) - 1
    
    all_new_ingredients = organ_meats
    
    # 插入新数据
    for ingredient in reversed(all_new_ingredients):  # 反向插入以保持顺序
        rows.insert(insert_position, ingredient)
    
    # 写回文件
    with open(input_file, 'w', encoding='utf-8', newline='') as f:
        writer = csv.writer(f)
        writer.writerows(rows)
    
    print(f"第四批扩展完成，成功添加 {len(all_new_ingredients)} 种食材:")
    print(f"- 内脏类: {len(organ_meats)} 种")
    print(f"本批新增: {len(all_new_ingredients)} 种食材")

if __name__ == "__main__":
    expand_database_batch4()